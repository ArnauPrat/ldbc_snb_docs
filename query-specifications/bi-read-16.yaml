workload: BI
operation: read
number: 16
title: Fake news detection
description: |
  Given two *Tag*/day pairs (`tagA`/`dayA` and `tagB`/`dayB`), for each pair `tagX`/`dayX`:

  * Create an induced subgraph between *Persons* where for each pair of *Persons* `person1`/`person2`, both have created a *Message* on `dayX` with *Tag* `tagX`.
  * In the induced subgraph, only keep pairs of *Persons* who have at most `maxKnowsLimit` friends (the number of friends is defined in the induced subgraph).
  * In the resulting graph, add the number of *Messages* created by each *Person*, resulting in graphs **Ga** and **Gb**.
  
  Compute the intersection of graphs **Ga** and **Gb** for `tagA`/`dayA` and `tagB`/`dayB`, return top pairs of *Persons* ordered by `<scoreA, scoreB>` descending.
parameters:
  - name: tagA
    type: Long String
  - name: dayA
    type: Date
  - name: tagB
    type: Long String
  - name: dayB
    type: Date
  - name: maxKnowsLimit
    type: 32-bit Integer
result:
  - name: person1.id
    type: ID
  - name: person2.id
    type: ID
  - name: \<scoreA, scoreB>
    type: \<32-bit Integer, 32-bit Integer>
    category: aggregated
    description: "`scoreX = count(message1) + count(message2)`, computed for `tagA`/`dayA` and `tagB`/`dayB`"
sort:
  - name: scoreA + scoreB
    direction: desc
choke_points: [1.1] #todo
